{% extends 'layout.html' %}
{% block content %}


<div class="container mb-4 pt-4">
    <h1>Perfumes</h1>
</div>
{% for perfume in perfumes %}
<div class="card">
    <h5 class="card-header text-white bg-primary">
        <a class="collapsed d-block" data-toggle="collapse" href="#id{{perfume['_id']}}" aria-expanded="true" aria-controls="id{{perfume['_id']}}" id="heading-collapsed">
            <i class="fa fa-chevron-down float-right"></i>
            {{ perfume['perfumeName'] }}
        </a>
    </h5>
    <div id="id{{perfume['_id']}}" class="collapse" aria-labelledby="heading-collapsed">
        <div class="card-body">
            <h5>A perfume by <span class="lead text-primary font-weight-bold">{{ perfume['perfumeBrand'] }}</span></h5>
            <p>Type: {{ perfume['perfumeType'] }}</p>
        </div>
        <div class="container pb-5">
            <div class="row justify-content-center">
                <div class="col-7">
                    <div class="card-body">
                        {{ perfume['perfumeDescription'] | safe}}
                    </div>
                </div>
                <div class="col-4">
                    <img class="float-right picture-perfume" src="{{ url_for('static', filename='images/perfume_pics/' + perfume['perfumePicture']) }}" alt="Avatar">
                </div>
            </div>
        </div>
        <hr>
        <div class="container pt-2 pb-4">
            <div class="row">
                <div class="col-7">
                    Posted by <span class="text-success">{{ perfume['username']}}</span>
                    <span class="text-muted">({{ perfume['firstName']}} {{ perfume['lastName']}})</span>
                    on {{ perfume.date_updated.strftime('%d-%m-%Y') }}<br>
                    {% if current_user.is_authenticated and current_user.is_admin == True and current_user.username == perfume['username'] %}
                    <a href="#" class="btn btn-primary btn-sm mt-2">Edit</a>
                    <button type="button" class="btn btn-danger btn-sm mt-2" data-toggle="modal" data-target="#deletePerfumeModal">Delete</button>
                    {% endif %}
                </div>
                <div class="col-4">
                    <img class="float-right avatar-perfume" src="{{ url_for('static', filename='images/avatars/' + perfume['profilePicture']) }}" alt="">
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal -->
<div class="modal fade" id="deletePerfumeModal" tabindex="-1" role="dialog" aria-labelledby="deletePerfumeModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteUserModal">Please Confirm Deletion</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Please confirm you want to delete this perfume.</p>
                <p><strong>This action cannot be undone.</strong></p>
            </div>
            <div class="modal-footer">
                <form action="{{ url_for('delete_perfume', id=perfume._id) }}" method="POST">
                    <input type="submit" , class="btn btn-danger" value="Delete">
                </form>
            </div>
        </div>
    </div>
</div>
{% endfor %}
{% if current_user.is_authenticated and current_user.is_admin == True %}
<div class="mt-5">
    <a href="{{ url_for('new_perfume') }}" class="btn btn-primary" type="button">Add new perfume</a>
</div>
{% endif %}

{% endblock content %}